local _,G,S,V,P,U=nil,game,pairs,Vector3.new,CFrame.new;local R,C,D,T=G:GetService("RunService"),G:GetService("CollectionService"),G:GetService("Debris"),G:GetService("Players");local f,g,h,i=math.min,math.max,math.floor,math.clamp;local j,k,l,m=os.clock,task.spawn,task.wait,pcall;local n,o=table.insert,table.remove;local s={{[1]={f=60,p=1,s=1},[2]={f=45,p=0.8,s=0.8},[3]={f=30,p=0.6,s=0.6}},t=60,e=30,r=45,a=0.05,b=300,c=0.0625,d=0.5,e=250,f=0.7,g=100,h=5,i=10,j=50,k="ManagedPhysics",l="ManagedScriptActivity"};local L={f=s.t,g=s[1][1],p="Normal",l=0,q=s.b,w=s.e};local A={x={},y={},z={},a={}};local B,K;local function D(t)local r,c,b={},string.char,bit32.bxor;for _,v in P(t)do n(r,c(b(v,17)))end;return table.concat(r)end;local function E(t)local u=s.g;return i(t.X/u).."_"..i(t.Y/u).."_"..i(t.Z/u)end;local function F(t,u)local v=E(t.Position);if not A.z[v]then A.z[v]={}end;n(A.z[v],t);u.v=v end;local function H(t,u)local v=u.v;if v and A.z[v]then for x= #A.z[v],1,-1 do if A.z[v][x]==t then o(A.z[v],x)break end end;if #A.z[v]==0 then A.z[v]=nil end;u.v=nil end end;local function J(t,u)local r={},v=s.g,c=i(u/v)+1,d,e,f=i(t.X/v),i(t.Y/v),i(t.Z/v);for x=d-c,d+c do for y=e-c,e+c do for z=f-c,f+c do local w=A.z[x.."_"..y.."_"..z];if w then for _,a in P(w)do if(a.Position-t).Magnitude<=u then n(r,a)end end end end end end;return r end;function L:f(d)if d==0 or d>1 then return end;local p=s.a;self.f=p*(1/d)+(1-p)*self.f;if self.p=="Normal"then if self.f<s.e then self.p="Emergency"end elseif self.p=="Emergency"then if self.f>s.r then self.p="Recovery"end elseif self.p=="Recovery"then if self.f<s.e then self.p="Emergency"elseif self.f>s.t*0.9 then self.p="Normal"end end;local q=s[1][1];if self.p=="Emergency"then q=s[1][3]elseif self.p=="Recovery"then q=s[1][2]else if self.f<s[1][2].f then q=s[1][3]elseif self.f<s[1][1].f then q=s[1][2]else q=s[1][1]end end;self.g=q;self.q=s.b*q.p;self.w=s.e*q.s end;function L:h(t)local u=A.x,v=s.c,w=self.q;local C=J(t,w);local D={};for _,x in P(C)do if x and x.Parent and x:IsA("BasePart")and not x.Anchored then local y=(x.Position-t).MagnitudeSqr;local z=y>(w*w)or x.AssemblyLinearVelocity.MagnitudeSqr<v;if x.Anchored~=z then x.Anchored=z;if z then x:SetNetworkOwner(nil)else x:SetNetworkOwner(B)end end;D[x]=true end end;for x,y in P(u)do if not D[x]then if x and x.Parent and x:IsA("BasePart")and x.Anchored then local z=(x.Position-t).MagnitudeSqr;if z<=(w*w)and x.AssemblyLinearVelocity.MagnitudeSqr>=v then x.Anchored=false;x:SetNetworkOwner(B)end end end end end;function L:i(t)local u=A.y,v=self.w;local w=v*v;for x=#u,1,-1 do local y=u[x];local z=y.z;if not y.y or not y.y.Parent or not z or not z.Parent then o(u,x);continue end;local A=(z.Position-t).MagnitudeSqr;local B=A>w;if y.y.Disabled~=B then y.y.Disabled=B end end end;function L:j()local u=0,v=s.h;while #A.a>0 and u<v do local w=o(A.a,1);if not w or not w.Parent or not w:IsDescendantOf(G)then goto C end;if C:HasTag(w,s.k)then local x={};if w:IsA("BasePart")then n(x,w)elseif w:IsA("Model")then for _,y in P(w:GetDescendants())do if y:IsA("BasePart")and not y.Anchored then n(x,y)end end end;for _,y in P(x)do if not A.x[y]then local z={y=y};A.x[y]=z;F(y,z);y.Destroying:Connect(function()H(y,z);A.x[y]=nil end)end end end;if C:HasTag(w,s.l)then local x={};if w:IsA("Script")or w:IsA("LocalScript")then n(x,w)else for _,y in P(w:GetDescendants())do if y:IsA("Script")or y:IsA("LocalScript")then n(x,y)end end end;for _,y in P(x)do local z=y.Parent:IsA("BasePart")and y.Parent or y.Parent:FindFirstAncestorWhichIsA("BasePart");if z and not A.y[y]then local B={y=y,z=z};n(A.y,B);y.Destroying:Connect(function()for x=#A.y,1,-1 do if A.y[x].y==y then o(A.y,x)break end end end)end end end;u+=1;::C:: end end;local Q={function()local u=0,v=A.x;for w,x in P(v)do if not w or not w.Parent then H(w,x);v[w]=nil;u+=1 end end;return u end,function()local u=0,v=A.y;for w=#v,1,-1 do local x=v[w];if not x.y or not x.y.Parent then o(v,w);u+=1 end end;return u end,};local M=1;function L:k()local u=Q[M];if not u then return end;u();M+=1;if M>#Q then M=1 end end;function L:a()B=D.LocalPlayer;if not B then D.PlayerAdded:Connect(function(t)if t==D.LocalPlayer then B=t end end)end;K=G.Workspace.CurrentCamera;if not K then G.Workspace:GetPropertyChangedSignal("CurrentCamera"):Connect(function()K=G.Workspace.CurrentCamera end)end;local function p(t)n(A.a,t)end;C:GetInstanceAddedSignal(s.k):Connect(p);C:GetInstanceAddedSignal(s.l):Connect(p);for _,t in C:GetTagged(s.k)do p(t)end;for _,t in C:GetTagged(s.l)do p(t)end;local T=j();R.Heartbeat:Connect(function(t)local u=j();local v=u-T;T=u;L:f(v)end);l(function()while true do L:j();m(0.1)end end);l(function()while true do if K and B and B.Character and B.Character.PrimaryPart then L:h(K.CFrame.Position)end;m(s.d)end end);l(function()while true do if K and B and B.Character and B.Character.PrimaryPart then L:i(K.CFrame.Position)end;m(s.f)end end);l(function()while true do L:k();m(2)end end);end;L:a();
